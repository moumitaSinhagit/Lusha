import React, { useState,useEffect } from 'react'
import "./Navbar.css"
import logo from "../../assets/logo.png"
import { Link } from 'react-router-dom';
import { useCart } from '../../Context/CartContext';
import SearchBar from '../SearchBar/SearchBar';

const Navbar = () => {
  const { cart } = useCart();
  const totalQuantity = cart.reduce((sum, item) => sum + item.quantity, 0);
  const [showSearch, setShowSearch] = useState(false);
  const toggleSearchBar = () => setShowSearch(!showSearch);
  const [products, setProducts] = useState([]);
    useEffect(() => {
      fetch('/product.json')
      .then(res => res.json())
      .then(data => {
          setProducts(data);
      });
  }, []);

  const handleOpenMenu = () => {
    const menu = document.getElementById('navbarSupportedContent');
    menu.classList.add('show');
    document.body.style.overflowY = 'hidden';
    
  };
  const handleCloseMenu = () => {
    const menu = document.getElementById('navbarSupportedContent');
    if (menu.classList.contains('show')) {
      menu.classList.remove('show');
      document.body.style.overflowY = '';
    }
  };

  return (
    <nav className="nvMain navbar navbar-expand-lg">
      <div className="container">
        <button
          className="navbar-toggler"
          type="button" onClick={handleOpenMenu}
        >
          <span className="navbar-toggler-icon">
            <svg width="27" height="21" viewBox="0 0 27 21" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1.21456 10.6751L16.5804 10.6181M1.18034 1.4556L25.7656 1.36434M1.24878 19.8946L7.39511 19.8718" stroke="black" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
          </span>
        </button>
        <Link className="navbar-brand" to="/">
          <img src={logo} alt="Logo" className="img-fluid" />
        </Link>
        <div
          className="collapse navbar-collapse justify-content-center"
          id="navbarSupportedContent"
        >
          <div className="navbar-inner-mob">
            <div className="mobo-logo">
              <div className="mobo-logo-innr">
                <img src={logo} alt="Logo" className="img-fluid" />
                <svg id="close-menu" onClick={handleCloseMenu} width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9.95335 11.5L0.881792 2.43063C0.780099 2.32893 0.699433 2.20821 0.644397 2.07534C0.589362 1.94247 0.561035 1.80007 0.561035 1.65625C0.561035 1.51244 0.589362 1.37003 0.644397 1.23716C0.699433 1.10429 0.780099 0.983568 0.881792 0.881875C0.983484 0.780183 1.10421 0.699517 1.23708 0.644481C1.36995 0.589446 1.51235 0.561119 1.65617 0.561119C1.79998 0.561119 1.94239 0.589446 2.07526 0.644481C2.20812 0.699517 2.32885 0.780183 2.43054 0.881875L11.4999 9.95344L20.5693 0.881875C20.7747 0.676498 21.0532 0.561119 21.3437 0.561119C21.6341 0.561119 21.9127 0.676498 22.118 0.881875C22.3234 1.08725 22.4388 1.3658 22.4388 1.65625C22.4388 1.9467 22.3234 2.22525 22.118 2.43063L13.0465 11.5L22.118 20.5694C22.3234 20.7748 22.4388 21.0533 22.4388 21.3438C22.4388 21.6342 22.3234 21.9127 22.118 22.1181C21.9127 22.3235 21.6341 22.4389 21.3437 22.4389C21.0532 22.4389 20.7747 22.3235 20.5693 22.1181L11.4999 13.0466L2.43054 22.1181C2.22516 22.3235 1.94661 22.4389 1.65617 22.4389C1.36572 22.4389 1.08717 22.3235 0.881792 22.1181C0.676414 21.9127 0.561035 21.6342 0.561035 21.3438C0.561035 21.0533 0.676414 20.7748 0.881792 20.5694L9.95335 11.5Z" fill="black"/>
                </svg>
              </div>
              <hr/>
            </div>
            <ul className="navbar-nav mb-2 mb-lg-0">
              <li className="nav-item">
                <Link className="nav-link" to="/">Home</Link>
              </li>
              <li className="nav-item">
                <Link className="nav-link" to="/shop">Shop</Link>
              </li>
              <li className="nav-item">
                <Link className="nav-link" to="/shop?bestseller=true">Best Sellers</Link>
              </li>
              <li className="nav-item">
                <Link className="nav-link" to="/about">About</Link>
              </li>
              <li className="nav-item">
                <Link className="nav-link" to="/contact">Contact</Link>
              </li>
              <li className="nav-item d-md-none d-block">
                <Link className="nav-link" to="/wishlist">Wishlist</Link>
              </li>
            </ul>
          </div>
          
        </div>
        <div className="navRght">
          <div onClick={toggleSearchBar}>
          <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M24.5 24.5L19.4332 19.4332M19.4332 19.4332C20.2999 18.5665 20.9874 17.5375 21.4564 16.4051C21.9255 15.2727 22.1669 14.059 22.1669 12.8333C22.1669 11.6076 21.9255 10.3939 21.4564 9.26153C20.9874 8.12913 20.2999 7.1002 19.4332 6.2335C18.5665 5.3668 17.5375 4.67929 16.4051 4.21024C15.2727 3.74118 14.059 3.49976 12.8333 3.49976C11.6076 3.49976 10.3939 3.74118 9.26153 4.21024C8.12912 4.67929 7.1002 5.3668 6.2335 6.2335C4.48311 7.98388 3.49976 10.3579 3.49976 12.8333C3.49976 15.3088 4.48311 17.6828 6.2335 19.4332C7.98388 21.1836 10.3579 22.1669 12.8333 22.1669C15.3087 22.1669 17.6828 21.1836 19.4332 19.4332Z" stroke="black" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
          </svg>
          </div>
          {showSearch && <SearchBar products={products} />}
          <Link to="/wishlist" className="d-md-block d-none">
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M15 6.875L14.325 7.525C14.4125 7.61574 14.5173 7.68791 14.6333 7.7372C14.7493 7.78649 14.874 7.8119 15 7.8119C15.126 7.8119 15.2507 7.78649 15.3667 7.7372C15.4827 7.68791 15.5875 7.61574 15.675 7.525L15 6.875ZM11.7825 22.9025C9.8875 21.4088 7.81625 19.95 6.1725 18.1C4.5625 16.285 3.4375 14.1688 3.4375 11.4213H1.5625C1.5625 14.7538 2.95 17.2963 4.77125 19.345C6.55875 21.3575 8.83875 22.97 10.6212 24.375L11.7825 22.9025ZM3.4375 11.4213C3.4375 8.73375 4.95625 6.47875 7.03 5.53C9.045 4.60875 11.7525 4.8525 14.325 7.525L15.675 6.22625C12.625 3.055 9.08 2.53125 6.25 3.825C3.4825 5.09125 1.5625 8.03125 1.5625 11.4213H3.4375ZM10.6212 24.375C11.2625 24.88 11.95 25.4175 12.6462 25.825C13.3425 26.2325 14.1375 26.5625 15 26.5625V24.6875C14.6125 24.6875 14.1575 24.5375 13.5925 24.2063C13.0262 23.8763 12.44 23.4213 11.7825 22.9025L10.6212 24.375ZM19.3787 24.375C21.1612 22.9688 23.4412 21.3588 25.2287 19.345C27.05 17.295 28.4375 14.7538 28.4375 11.4213H26.5625C26.5625 14.1688 25.4375 16.285 23.8275 18.1C22.1837 19.95 20.1125 21.4088 18.2175 22.9025L19.3787 24.375ZM28.4375 11.4213C28.4375 8.03125 26.5187 5.09125 23.75 3.825C20.92 2.53125 17.3775 3.055 14.325 6.225L15.675 7.525C18.2475 4.85375 20.955 4.60875 22.97 5.53C25.0437 6.47875 26.5625 8.7325 26.5625 11.4213H28.4375ZM18.2175 22.9025C17.56 23.4213 16.9737 23.8763 16.4075 24.2063C15.8412 24.5363 15.3875 24.6875 15 24.6875V26.5625C15.8625 26.5625 16.6575 26.2313 17.3537 25.825C18.0512 25.4175 18.7375 24.88 19.3787 24.375L18.2175 22.9025Z" fill="black"/>
            </svg>
          </Link>
          <Link to="/cart">
            <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fillRule="evenodd" clipRule="evenodd" d="M14 3.20833C13.3038 3.20833 12.6361 3.48489 12.1438 3.97718C11.6515 4.46946 11.375 5.13714 11.375 5.83333V6.13667C12.0248 6.125 12.7376 6.125 13.5216 6.125H14.4795C15.2611 6.125 15.9751 6.125 16.6261 6.13667V5.83333C16.6261 5.48851 16.5582 5.14707 16.4262 4.82852C16.2942 4.50996 16.1008 4.22053 15.8569 3.97676C15.613 3.733 15.3235 3.53966 15.0049 3.40781C14.6863 3.27596 14.3448 3.20818 14 3.20833ZM18.375 6.216V5.83333C18.375 4.67301 17.914 3.56021 17.0936 2.73974C16.2731 1.91927 15.1603 1.45833 14 1.45833C12.8396 1.45833 11.7269 1.91927 10.9064 2.73974C10.0859 3.56021 9.62497 4.67301 9.62497 5.83333V6.216C9.45853 6.23 9.29753 6.24672 9.14197 6.26616C7.96364 6.412 6.99297 6.71766 6.16697 7.4025C5.34097 8.08733 4.86264 8.98566 4.5033 10.1173C4.1533 11.214 3.88964 12.6222 3.5583 14.3943L3.5338 14.5227C3.0648 17.0228 2.69614 18.9933 2.6273 20.5462C2.5573 22.1387 2.7953 23.457 3.69364 24.5385C4.59197 25.6212 5.8438 26.0972 7.42114 26.3223C8.96114 26.5417 10.9643 26.5417 13.5088 26.5417H14.4946C17.038 26.5417 19.0423 26.5417 20.5811 26.3223C22.1585 26.0972 23.4115 25.6212 24.3098 24.5385C25.2081 23.4558 25.4438 22.1387 25.375 20.5462C25.3073 18.9933 24.9375 17.0228 24.4685 14.5227L24.4451 14.3943C24.1126 12.6222 23.8478 11.2128 23.5001 10.1173C23.1385 8.98566 22.6601 8.08733 21.8341 7.4025C21.0093 6.71766 20.0375 6.41083 18.8591 6.26616C18.6985 6.2464 18.5374 6.22967 18.3761 6.216M9.35664 8.00333C8.35914 8.12583 7.75597 8.358 7.28464 8.75C6.81447 9.13967 6.47497 9.68917 6.1693 10.6482C5.8578 11.6282 5.61164 12.9325 5.2663 14.7747C4.78097 17.3612 4.4368 19.208 4.37497 20.6232C4.3143 22.0115 4.5383 22.8165 5.0388 23.422C5.54047 24.0252 6.29064 24.3927 7.6673 24.5887C9.0673 24.7893 10.948 24.7917 13.58 24.7917H14.42C17.0531 24.7917 18.9315 24.7893 20.3326 24.5898C21.7093 24.3927 22.4595 24.0252 22.9611 23.422C23.4628 22.8177 23.6856 22.0127 23.6261 20.622C23.5631 19.2092 23.219 17.3612 22.7336 14.7747C22.3883 12.9313 22.1433 11.6293 21.8306 10.6482C21.525 9.68917 21.1866 9.13967 20.7153 8.74883C20.244 8.358 19.642 8.12583 18.6433 8.00217C17.6213 7.87617 16.2948 7.875 14.42 7.875H13.58C11.7051 7.875 10.3786 7.87617 9.35664 8.00333Z" fill="black"/>
            </svg>
            {totalQuantity > 0 && (
            <span className="count">{totalQuantity}</span>
            )}
          </Link>
        </div>
      </div>
    </nav>
  )
}

export default Navbar
